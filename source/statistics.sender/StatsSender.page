Menu="Buttons:10"
Link="nav-user"
---
<?
$plugin = "statistics.sender";

function lsDir($root, $ext = null)
{
  $iter = new RecursiveIteratorIterator(
          new RecursiveDirectoryIterator($root,
          RecursiveDirectoryIterator::SKIP_DOTS),
          RecursiveIteratorIterator::SELF_FIRST,
          RecursiveIteratorIterator::CATCH_GET_CHILD);
  $paths = [];
  foreach ($iter as $path => $fileinfo)
  {
    $fext = $fileinfo->getExtension();
    if ($ext && ($ext != $fext))
    {
      continue;
    }
    if ($fileinfo->isFile())
    {
      $paths[] = $path;
    }
  }
  return $paths;
}


function getReports()
{
  return lsDir("/boot/config/plugins/","sreport");
}

?>
<script type="text/javascript">
  var SenderURL = '/plugins/<?=$plugin;?>/StatsSender.php'

  <?if (count(getReports())):?>
  $(function(){
    getAvailableReports();
  });
  <?endif;?>
</script>